<div class="d-flex w-100 h-100 flex-column justify-content-between" >
  <div #stats class="hud stats">
    <div class="container-fluid">
      <div class="row">
        <!-- <div > -->
          <app-progress-bar class="col-12" color="#505ccc" [partCount]="24" [progress]="15"></app-progress-bar>
          <app-progress-bar class="col-4" color="darkred" [partCount]="4" [progress]="3"></app-progress-bar>
        <!-- </div> -->
      </div>
    </div>
  </div>

  <div #scrollContainer class="d-flex main content"
    class="d-flex main content"
    [class.grabbing]="isDragging"
    (mousedown)="onMouseDown($event)"
    (mousemove)="onMouseMove($event)"
    (mouseup)="onMouseUp()">
  <!-- <app-user-card *ngFor="let scenario of scenarios" [scenario]="scenario"></app-user-card> -->

  <div class="d-flex" style="overflow: auto;">
    <div>
      <app-tile *ngFor="let tile of tiles"
        style="position: absolute;"
        [style.left.px]="(tile.x * (width + margin)) + (tile.y % 2 * (width / 2))"
        [style.top.px]="(tile.y * (height * 0.75 + margin))"
        [color]="tile.color"
        [x]="tile.x"
        [y]="tile.y"
        [class]="tile.class"
        [display]="tile.display"
        [height]="height"
        [selected]="selectedStart?.x === tile.x && selectedStart?.y === tile.y"
  [endSelected]="selectedEnd?.x === tile.x && selectedEnd?.y === tile.y"
  [inPath]="isInPath(tile.x, tile.y)"
  (tileClicked)="onTileClicked($event)">
      </app-tile>
    </div>

  </div>
<div class="tabs">
  <div *ngFor="let tab of tabs" #tab (click)="openModal()">{{tab}}</div>
</div>
<div #footer class="hud footer d-flex justify-content-between align-items-center">
  <div>Postać</div>
  <div style="width: 40%;">
    <app-progress-bar class="balance" color="yellow" [partCount]="6" [progress]="3"></app-progress-bar>
  </div>
  <div #endTurn class="endTurn">Zakończ turę</div>
</div>

<!-- Modal -->
<div class="modal-backdrop" [hidden]="!isModalOpen" (click)="closeModal()">
  <div class="modal-window" #finance (click)="$event.stopPropagation()">
    <h2>Finanse</h2>
    <hr />

    <!-- Saldo -->
    <div class="finance-summary">
      <p><strong>Saldo konta:</strong> <span>{{ player.saldo | number:'1.0-2' }}</span> zł</p>
      <p><strong>Pensja brutto:</strong> {{ player.salaryBrutto | number:'1.0-2' }} zł / msc</p>
      <p><strong>Na rękę:</strong> {{ player.salaryNetto | number:'1.0-2' }} zł / msc</p>
    </div>

    <hr />

    <!-- Składki ZUS -->
    <h3>Składki ZUS</h3>
    <table class="finance-table">
      <thead>
        <tr>
          <th>Rodzaj składki</th>
          <th>Kwota (zł)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Emerytalna</td>
          <td>{{ player.zus.emerytalna | number:'1.0-2' }}</td>
        </tr>
        <tr>
          <td>Rentowa</td>
          <td>{{ player.zus.rentowa | number:'1.0-2' }}</td>
        </tr>
        <tr>
          <td>Chorobowa</td>
          <td>{{ player.zus.chorobowa | number:'1.0-2' }}</td>
        </tr>
        <tr>
          <td>Zdrowotna</td>
          <td>{{ player.zus.zdrowotna | number:'1.0-2' }}</td>
        </tr>
      </tbody>
      <tfoot>
        <tr>
          <th>Razem składki ZUS</th>
          <th>{{ player.zus.razem | number:'1.0-2' }}</th>
        </tr>
      </tfoot>
    </table>

    <hr />

    <!-- Wydatki -->
    <h3>Wydatki stałe</h3>
    <p><strong>Miesięczne wydatki:</strong> {{ player.wydatki_stale | number:'1.0-2' }} zł</p>

    <hr />

    <!-- Podsumowanie -->
    <h3>Podsumowanie</h3>
    <p><strong>Wolne środki / msc:</strong>
      <span [ngClass]="{'negative': player.salaryNetto - player.wydatki_stale < 0}">
        {{ player.salaryNetto - player.wydatki_stale | number:'1.0-2' }} zł
      </span>
    </p>

    <div class="modal-actions">
      <button (click)="closeModal()">Zamknij</button>
    </div>
  </div>
</div>

